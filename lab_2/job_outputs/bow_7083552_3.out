Requirement already satisfied: nltk in /home/lgpu0388/.conda/envs/dl2020/lib/python3.7/site-packages (3.5)
Requirement already satisfied: tqdm in /home/lgpu0388/.conda/envs/dl2020/lib/python3.7/site-packages (from nltk) (4.50.2)
Requirement already satisfied: click in /home/lgpu0388/.conda/envs/dl2020/lib/python3.7/site-packages (from nltk) (7.1.2)
Requirement already satisfied: regex in /home/lgpu0388/.conda/envs/dl2020/lib/python3.7/site-packages (from nltk) (2020.11.13)
Requirement already satisfied: joblib in /home/lgpu0388/.conda/envs/dl2020/lib/python3.7/site-packages (from nltk) (0.17.0)
Training a DeepCBOW model.
Device: cuda
Loading data...

Loading vocabulary from training data
Permute is turned off.
Training new model with seed 0
==================================================
Shuffling training data
Iter 1000: loss=1796.3592, time=4.29s
iter 1000: dev acc=0.2416
new highscore
Iter 2000: loss=1696.7260, time=9.25s
iter 2000: dev acc=0.2625
new highscore
Iter 3000: loss=1649.1759, time=14.18s
iter 3000: dev acc=0.2816
new highscore
Iter 4000: loss=1600.0504, time=19.14s
iter 4000: dev acc=0.2779
Iter 5000: loss=1566.4818, time=23.75s
iter 5000: dev acc=0.3224
new highscore
Iter 6000: loss=1593.4677, time=28.78s
iter 6000: dev acc=0.2997
Iter 7000: loss=1567.6634, time=33.40s
iter 7000: dev acc=0.3233
new highscore
Iter 8000: loss=1568.5126, time=38.35s
iter 8000: dev acc=0.3106
Shuffling training data
Iter 9000: loss=1480.9201, time=42.99s
iter 9000: dev acc=0.2879
Iter 10000: loss=1458.8653, time=47.61s
iter 10000: dev acc=0.3388
new highscore
Iter 11000: loss=1423.8220, time=52.54s
iter 11000: dev acc=0.3170
Iter 12000: loss=1449.1635, time=57.29s
iter 12000: dev acc=0.3252
Iter 13000: loss=1459.8770, time=61.90s
iter 13000: dev acc=0.3161
Iter 14000: loss=1446.3725, time=66.51s
iter 14000: dev acc=0.3315
Iter 15000: loss=1407.8396, time=71.10s
iter 15000: dev acc=0.3324
Iter 16000: loss=1437.6117, time=75.71s
iter 16000: dev acc=0.3406
new highscore
Iter 17000: loss=1411.5097, time=80.66s
iter 17000: dev acc=0.3451
new highscore
Shuffling training data
Iter 18000: loss=1252.4481, time=85.62s
iter 18000: dev acc=0.3415
Iter 19000: loss=1272.0906, time=90.25s
iter 19000: dev acc=0.3606
new highscore
Iter 20000: loss=1275.0626, time=95.27s
iter 20000: dev acc=0.3515
Iter 21000: loss=1278.6330, time=99.99s
iter 21000: dev acc=0.3497
Iter 22000: loss=1272.1183, time=104.68s
iter 22000: dev acc=0.3606
Iter 23000: loss=1258.3703, time=109.39s
iter 23000: dev acc=0.3479
Iter 24000: loss=1275.4719, time=113.92s
iter 24000: dev acc=0.3351
Iter 25000: loss=1294.4270, time=118.46s
iter 25000: dev acc=0.3333
Shuffling training data
Iter 26000: loss=1168.3881, time=123.19s
iter 26000: dev acc=0.3651
new highscore
Iter 27000: loss=1094.0245, time=128.22s
iter 27000: dev acc=0.3270
Iter 28000: loss=1099.8334, time=132.96s
iter 28000: dev acc=0.3569
Iter 29000: loss=1085.5012, time=137.67s
iter 29000: dev acc=0.3424
Iter 30000: loss=1084.9718, time=142.40s
iter 30000: dev acc=0.3406
Iter 31000: loss=1156.0012, time=147.13s
iter 31000: dev acc=0.3470
Iter 32000: loss=1132.3127, time=151.83s
iter 32000: dev acc=0.3415
Iter 33000: loss=1108.5090, time=156.51s
iter 33000: dev acc=0.3488
Iter 34000: loss=1107.2708, time=161.18s
iter 34000: dev acc=0.3606
Shuffling training data
Iter 35000: loss=932.0925, time=165.87s
iter 35000: dev acc=0.3506
Iter 36000: loss=876.6448, time=170.53s
iter 36000: dev acc=0.3442
Iter 37000: loss=936.6815, time=175.27s
iter 37000: dev acc=0.3351
Iter 38000: loss=960.3864, time=179.96s
iter 38000: dev acc=0.3442
Iter 39000: loss=939.8083, time=184.70s
iter 39000: dev acc=0.3497
Iter 40000: loss=937.3639, time=189.41s
iter 40000: dev acc=0.3424
Iter 41000: loss=990.1707, time=194.09s
iter 41000: dev acc=0.3388
Iter 42000: loss=994.9218, time=198.74s
iter 42000: dev acc=0.3370
Shuffling training data
Iter 43000: loss=879.2286, time=203.40s
iter 43000: dev acc=0.3406
Iter 44000: loss=713.2628, time=208.06s
iter 44000: dev acc=0.3597
Iter 45000: loss=752.1264, time=212.72s
iter 45000: dev acc=0.3533
Iter 46000: loss=761.1890, time=217.38s
iter 46000: dev acc=0.3569
Stopping early because there was no improvement for 20000 steps
Done training
Loading best model
best model iter 26000: train acc=0.5779, dev acc=0.3651, test acc=0.3525
Training new model with seed 1
==================================================
Shuffling training data
Iter 1000: loss=1815.7910, time=4.08s
iter 1000: dev acc=0.2679
new highscore
Iter 2000: loss=1707.6462, time=9.06s
iter 2000: dev acc=0.2752
new highscore
Iter 3000: loss=1655.8989, time=14.06s
iter 3000: dev acc=0.2725
Iter 4000: loss=1630.1307, time=18.69s
iter 4000: dev acc=0.3088
new highscore
Iter 5000: loss=1599.2659, time=23.69s
iter 5000: dev acc=0.2970
Iter 6000: loss=1607.0705, time=28.32s
iter 6000: dev acc=0.3061
Iter 7000: loss=1557.4177, time=32.96s
iter 7000: dev acc=0.2997
Iter 8000: loss=1577.3153, time=37.63s
iter 8000: dev acc=0.3215
new highscore
Shuffling training data
Iter 9000: loss=1513.8292, time=42.64s
iter 9000: dev acc=0.3070
Iter 10000: loss=1461.3834, time=47.27s
iter 10000: dev acc=0.3333
new highscore
Iter 11000: loss=1443.4730, time=52.26s
iter 11000: dev acc=0.3506
new highscore
Iter 12000: loss=1428.7482, time=57.27s
iter 12000: dev acc=0.3152
Iter 13000: loss=1412.8033, time=61.91s
iter 13000: dev acc=0.3270
Iter 14000: loss=1429.9553, time=66.52s
iter 14000: dev acc=0.3361
Iter 15000: loss=1466.8963, time=71.14s
iter 15000: dev acc=0.3252
Iter 16000: loss=1438.5055, time=75.80s
iter 16000: dev acc=0.3233
Iter 17000: loss=1410.2502, time=80.42s
iter 17000: dev acc=0.3288
Shuffling training data
Iter 18000: loss=1284.9553, time=85.09s
iter 18000: dev acc=0.3224
Iter 19000: loss=1255.5945, time=89.73s
iter 19000: dev acc=0.3261
Iter 20000: loss=1301.6342, time=94.41s
iter 20000: dev acc=0.3115
Iter 21000: loss=1270.8546, time=99.03s
iter 21000: dev acc=0.3460
Iter 22000: loss=1287.8353, time=103.68s
iter 22000: dev acc=0.3579
new highscore
Iter 23000: loss=1303.7882, time=108.67s
iter 23000: dev acc=0.3342
Iter 24000: loss=1266.4728, time=113.32s
iter 24000: dev acc=0.3152
Iter 25000: loss=1263.6572, time=117.97s
iter 25000: dev acc=0.3660
new highscore
Shuffling training data
Iter 26000: loss=1175.7173, time=123.00s
iter 26000: dev acc=0.3678
new highscore
Iter 27000: loss=1049.4171, time=128.00s
iter 27000: dev acc=0.3479
Iter 28000: loss=1096.1886, time=132.63s
iter 28000: dev acc=0.3306
Iter 29000: loss=1122.8827, time=137.23s
iter 29000: dev acc=0.3351
Iter 30000: loss=1094.4599, time=141.87s
iter 30000: dev acc=0.3415
Iter 31000: loss=1107.7893, time=146.52s
iter 31000: dev acc=0.3351
Iter 32000: loss=1148.9029, time=151.19s
iter 32000: dev acc=0.3433
Iter 33000: loss=1139.7866, time=155.85s
iter 33000: dev acc=0.3451
Iter 34000: loss=1155.2489, time=160.50s
iter 34000: dev acc=0.3361
Shuffling training data
Iter 35000: loss=964.5895, time=165.16s
iter 35000: dev acc=0.3279
Iter 36000: loss=892.1868, time=169.81s
iter 36000: dev acc=0.3333
Iter 37000: loss=946.9089, time=174.50s
iter 37000: dev acc=0.3351
Iter 38000: loss=979.6134, time=179.13s
iter 38000: dev acc=0.3243
Iter 39000: loss=945.5328, time=183.79s
iter 39000: dev acc=0.3379
Iter 40000: loss=965.7758, time=188.47s
iter 40000: dev acc=0.3243
Iter 41000: loss=973.6596, time=193.13s
iter 41000: dev acc=0.3479
Iter 42000: loss=948.8738, time=197.78s
iter 42000: dev acc=0.3388
Shuffling training data
Iter 43000: loss=890.9130, time=202.42s
iter 43000: dev acc=0.3361
Iter 44000: loss=719.2528, time=207.07s
iter 44000: dev acc=0.3424
Iter 45000: loss=750.7833, time=211.74s
iter 45000: dev acc=0.3324
Iter 46000: loss=779.1720, time=216.41s
iter 46000: dev acc=0.3233
Stopping early because there was no improvement for 20000 steps
Done training
Loading best model
best model iter 26000: train acc=0.5612, dev acc=0.3678, test acc=0.3760
Training new model with seed 2
==================================================
Shuffling training data
Iter 1000: loss=1782.1643, time=4.03s
iter 1000: dev acc=0.2870
new highscore
Iter 2000: loss=1694.5742, time=8.98s
iter 2000: dev acc=0.2698
Iter 3000: loss=1623.4781, time=13.62s
iter 3000: dev acc=0.2788
Iter 4000: loss=1644.2845, time=18.26s
iter 4000: dev acc=0.2797
Iter 5000: loss=1627.1984, time=22.92s
iter 5000: dev acc=0.2770
Iter 6000: loss=1571.5452, time=27.60s
iter 6000: dev acc=0.3052
new highscore
Iter 7000: loss=1557.3812, time=32.56s
iter 7000: dev acc=0.3034
Iter 8000: loss=1538.6322, time=37.21s
iter 8000: dev acc=0.2897
Shuffling training data
Iter 9000: loss=1491.2594, time=41.84s
iter 9000: dev acc=0.3043
Iter 10000: loss=1479.0366, time=46.49s
iter 10000: dev acc=0.2906
Iter 11000: loss=1391.7951, time=51.18s
iter 11000: dev acc=0.3206
new highscore
Iter 12000: loss=1412.7275, time=56.18s
iter 12000: dev acc=0.3243
new highscore
Iter 13000: loss=1450.8817, time=61.16s
iter 13000: dev acc=0.3252
new highscore
Iter 14000: loss=1423.4248, time=66.16s
iter 14000: dev acc=0.3397
new highscore
Iter 15000: loss=1417.1095, time=71.12s
iter 15000: dev acc=0.3451
new highscore
Iter 16000: loss=1402.5413, time=76.12s
iter 16000: dev acc=0.3497
new highscore
Iter 17000: loss=1427.6113, time=81.09s
iter 17000: dev acc=0.3588
new highscore
Shuffling training data
Iter 18000: loss=1218.6420, time=86.08s
iter 18000: dev acc=0.3370
Iter 19000: loss=1256.6937, time=90.72s
iter 19000: dev acc=0.3579
Iter 20000: loss=1265.9161, time=95.42s
iter 20000: dev acc=0.3315
Iter 21000: loss=1282.8430, time=100.05s
iter 21000: dev acc=0.3388
Iter 22000: loss=1269.4326, time=104.72s
iter 22000: dev acc=0.3424
Iter 23000: loss=1263.0558, time=109.35s
iter 23000: dev acc=0.3697
new highscore
Iter 24000: loss=1262.4148, time=114.30s
iter 24000: dev acc=0.3633
Iter 25000: loss=1263.6453, time=118.95s
iter 25000: dev acc=0.3751
new highscore
Shuffling training data
Iter 26000: loss=1181.3990, time=123.98s
iter 26000: dev acc=0.3597
Iter 27000: loss=1073.4243, time=128.61s
iter 27000: dev acc=0.3669
Iter 28000: loss=1042.3522, time=133.24s
iter 28000: dev acc=0.3688
Iter 29000: loss=1075.8112, time=137.87s
iter 29000: dev acc=0.3588
Iter 30000: loss=1106.9853, time=142.52s
iter 30000: dev acc=0.3688
Iter 31000: loss=1134.2799, time=147.22s
iter 31000: dev acc=0.3669
Iter 32000: loss=1055.8352, time=151.86s
iter 32000: dev acc=0.3597
Iter 33000: loss=1114.6396, time=156.48s
iter 33000: dev acc=0.3460
Iter 34000: loss=1129.0253, time=161.09s
iter 34000: dev acc=0.3869
new highscore
Shuffling training data
Iter 35000: loss=905.9513, time=166.10s
iter 35000: dev acc=0.3560
Iter 36000: loss=905.1206, time=170.78s
iter 36000: dev acc=0.3506
Iter 37000: loss=849.6886, time=175.44s
iter 37000: dev acc=0.3479
Iter 38000: loss=924.8941, time=180.12s
iter 38000: dev acc=0.3551
Iter 39000: loss=964.1954, time=184.80s
iter 39000: dev acc=0.3760
Iter 40000: loss=917.1678, time=189.46s
iter 40000: dev acc=0.3833
Iter 41000: loss=957.2406, time=194.06s
iter 41000: dev acc=0.3688
Iter 42000: loss=961.8976, time=198.73s
iter 42000: dev acc=0.3787
Shuffling training data
Iter 43000: loss=946.2881, time=203.38s
iter 43000: dev acc=0.3651
Iter 44000: loss=689.0586, time=208.00s
iter 44000: dev acc=0.3660
Iter 45000: loss=704.8880, time=212.65s
iter 45000: dev acc=0.3542
Iter 46000: loss=757.4702, time=217.28s
iter 46000: dev acc=0.3542
Iter 47000: loss=760.9517, time=221.93s
iter 47000: dev acc=0.3515
Iter 48000: loss=745.0332, time=226.57s
iter 48000: dev acc=0.3533
Iter 49000: loss=788.4198, time=231.22s
iter 49000: dev acc=0.3633
Iter 50000: loss=857.3650, time=235.84s
iter 50000: dev acc=0.3733
Iter 51000: loss=792.9507, time=240.45s
iter 51000: dev acc=0.3706
Shuffling training data
Iter 52000: loss=631.7923, time=245.10s
iter 52000: dev acc=0.3633
Iter 53000: loss=591.4314, time=249.72s
iter 53000: dev acc=0.3688
Iter 54000: loss=587.1581, time=254.34s
iter 54000: dev acc=0.3579
Stopping early because there was no improvement for 20000 steps
Done training
Loading best model
best model iter 34000: train acc=0.6628, dev acc=0.3869, test acc=0.3824
Test accuracy: 0.3702865761689291 +- 0.012847987595201702
/home/lgpu0388/.conda/envs/dl2020/lib/python3.7/site-packages/numpy/core/_asarray.py:136: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  return array(a, dtype, copy=False, order=order, subok=True)
