Training a LSTM model.
Warning: Using pretrained embedding, will override given embedding dimension.
Loading data...
Loading pretrained embedding...
Permute is turned on!
Training new model with seed 0
==================================================
Shuffling training data
Iter 50: loss=79.5797, time=4.84s
iter 50: dev acc=0.2616
new highscore
Shuffling training data
Iter 100: loss=77.9149, time=9.60s
iter 100: dev acc=0.3034
new highscore
Shuffling training data
Iter 150: loss=77.7428, time=14.30s
iter 150: dev acc=0.3124
new highscore
Iter 200: loss=72.7495, time=18.89s
iter 200: dev acc=0.3896
new highscore
Shuffling training data
Iter 250: loss=70.5106, time=23.89s
iter 250: dev acc=0.3924
new highscore
Shuffling training data
Iter 300: loss=68.3348, time=28.82s
iter 300: dev acc=0.4060
new highscore
Shuffling training data
Iter 350: loss=67.3516, time=33.68s
iter 350: dev acc=0.4033
Iter 400: loss=66.2647, time=38.28s
iter 400: dev acc=0.4142
new highscore
Shuffling training data
Iter 450: loss=65.2641, time=42.97s
iter 450: dev acc=0.4214
new highscore
Shuffling training data
Iter 500: loss=64.6317, time=47.37s
iter 500: dev acc=0.4133
Shuffling training data
Iter 550: loss=63.9434, time=51.55s
iter 550: dev acc=0.4124
Iter 600: loss=63.7338, time=56.15s
iter 600: dev acc=0.4287
new highscore
Shuffling training data
Iter 650: loss=63.1925, time=60.90s
iter 650: dev acc=0.4269
Shuffling training data
Iter 700: loss=62.3530, time=65.45s
iter 700: dev acc=0.4151
Shuffling training data
Iter 750: loss=62.4879, time=70.06s
iter 750: dev acc=0.4124
Iter 800: loss=62.4012, time=74.57s
iter 800: dev acc=0.4214
Shuffling training data
Iter 850: loss=61.8348, time=79.21s
iter 850: dev acc=0.4242
Shuffling training data
Iter 900: loss=61.4114, time=83.80s
iter 900: dev acc=0.4360
new highscore
Shuffling training data
Iter 950: loss=62.1563, time=88.73s
iter 950: dev acc=0.4187
Iter 1000: loss=61.3647, time=93.23s
iter 1000: dev acc=0.4369
new highscore
Shuffling training data
Iter 1050: loss=60.9174, time=97.40s
iter 1050: dev acc=0.4305
Shuffling training data
Iter 1100: loss=60.3519, time=101.34s
iter 1100: dev acc=0.4414
new highscore
Shuffling training data
Iter 1150: loss=61.2865, time=105.68s
iter 1150: dev acc=0.4323
Iter 1200: loss=60.1830, time=110.25s
iter 1200: dev acc=0.4260
Shuffling training data
Iter 1250: loss=59.9533, time=114.81s
iter 1250: dev acc=0.4323
Shuffling training data
Iter 1300: loss=60.3310, time=119.35s
iter 1300: dev acc=0.4233
Shuffling training data
Iter 1350: loss=59.4818, time=123.93s
iter 1350: dev acc=0.4351
Iter 1400: loss=59.3902, time=128.39s
iter 1400: dev acc=0.4260
Shuffling training data
Iter 1450: loss=58.7554, time=132.40s
iter 1450: dev acc=0.4332
Shuffling training data
Iter 1500: loss=58.8527, time=136.37s
iter 1500: dev acc=0.4414
Shuffling training data
Iter 1550: loss=58.9820, time=140.61s
iter 1550: dev acc=0.4296
Iter 1600: loss=58.2113, time=145.16s
iter 1600: dev acc=0.4332
Shuffling training data
Iter 1650: loss=58.6444, time=149.67s
iter 1650: dev acc=0.4296
Shuffling training data
Iter 1700: loss=57.7173, time=153.82s
iter 1700: dev acc=0.4178
Shuffling training data
Iter 1750: loss=57.9919, time=158.59s
iter 1750: dev acc=0.4369
Iter 1800: loss=57.7960, time=163.22s
iter 1800: dev acc=0.4305
Shuffling training data
Iter 1850: loss=56.5593, time=167.91s
iter 1850: dev acc=0.4287
Shuffling training data
Iter 1900: loss=57.4381, time=172.67s
iter 1900: dev acc=0.4269
Shuffling training data
Iter 1950: loss=56.5194, time=177.46s
iter 1950: dev acc=0.4260
Iter 2000: loss=56.9222, time=182.15s
iter 2000: dev acc=0.4242
Shuffling training data
Iter 2050: loss=56.0868, time=186.69s
iter 2050: dev acc=0.4196
Shuffling training data
Iter 2100: loss=55.5724, time=191.19s
iter 2100: dev acc=0.4269
Stopping early because there was no improvement for 1000 steps
Done training
Loading best model
best model iter 1100: train acc=0.4723, dev acc=0.4378, test acc=0.4457
Training new model with seed 1
==================================================
Shuffling training data
Iter 50: loss=79.8275, time=4.22s
iter 50: dev acc=0.2525
new highscore
Shuffling training data
Iter 100: loss=78.1332, time=8.47s
iter 100: dev acc=0.2688
new highscore
Shuffling training data
Iter 150: loss=77.3551, time=12.96s
iter 150: dev acc=0.3615
new highscore
Iter 200: loss=73.0348, time=17.09s
iter 200: dev acc=0.3742
new highscore
Shuffling training data
Iter 250: loss=70.0624, time=21.41s
iter 250: dev acc=0.3851
new highscore
Shuffling training data
Iter 300: loss=69.2829, time=26.10s
iter 300: dev acc=0.3824
Shuffling training data
Iter 350: loss=67.6038, time=30.73s
iter 350: dev acc=0.3942
new highscore
Iter 400: loss=66.4756, time=35.30s
iter 400: dev acc=0.4033
new highscore
Shuffling training data
Iter 450: loss=65.1700, time=40.01s
iter 450: dev acc=0.4105
new highscore
Shuffling training data
Iter 500: loss=65.1400, time=44.79s
iter 500: dev acc=0.4205
new highscore
Shuffling training data
Iter 550: loss=64.2291, time=49.43s
iter 550: dev acc=0.4051
Iter 600: loss=63.5615, time=53.64s
iter 600: dev acc=0.4169
Shuffling training data
Iter 650: loss=63.3431, time=58.06s
iter 650: dev acc=0.4205
Shuffling training data
Iter 700: loss=62.9093, time=62.53s
iter 700: dev acc=0.4369
new highscore
Shuffling training data
Iter 750: loss=62.5125, time=67.61s
iter 750: dev acc=0.4278
Iter 800: loss=62.6029, time=72.50s
iter 800: dev acc=0.4169
Shuffling training data
Iter 850: loss=61.5479, time=76.93s
iter 850: dev acc=0.4251
Shuffling training data
Iter 900: loss=62.0068, time=81.21s
iter 900: dev acc=0.4251
Shuffling training data
Iter 950: loss=61.2720, time=85.42s
iter 950: dev acc=0.4287
Iter 1000: loss=60.8893, time=89.38s
iter 1000: dev acc=0.4287
Shuffling training data
Iter 1050: loss=60.7567, time=93.51s
iter 1050: dev acc=0.4342
Shuffling training data
Iter 1100: loss=60.7861, time=97.48s
iter 1100: dev acc=0.4323
Shuffling training data
Iter 1150: loss=60.2268, time=101.48s
iter 1150: dev acc=0.4287
Iter 1200: loss=59.9687, time=105.46s
iter 1200: dev acc=0.4287
Shuffling training data
Iter 1250: loss=59.8697, time=109.51s
iter 1250: dev acc=0.4287
Shuffling training data
Iter 1300: loss=59.4769, time=113.37s
iter 1300: dev acc=0.4214
Shuffling training data
Iter 1350: loss=59.4165, time=117.28s
iter 1350: dev acc=0.4405
new highscore
Iter 1400: loss=59.3291, time=121.36s
iter 1400: dev acc=0.4469
new highscore
Shuffling training data
Iter 1450: loss=58.7350, time=125.33s
iter 1450: dev acc=0.4233
Shuffling training data
Iter 1500: loss=57.8620, time=129.28s
iter 1500: dev acc=0.4287
Shuffling training data
Iter 1550: loss=58.2832, time=133.28s
iter 1550: dev acc=0.4269
Iter 1600: loss=58.1221, time=137.70s
iter 1600: dev acc=0.4269
Shuffling training data
Iter 1650: loss=57.5221, time=141.89s
iter 1650: dev acc=0.4214
Shuffling training data
Iter 1700: loss=56.9164, time=145.85s
iter 1700: dev acc=0.4178
Shuffling training data
Iter 1750: loss=58.1215, time=149.90s
iter 1750: dev acc=0.4260
Iter 1800: loss=56.5359, time=153.79s
iter 1800: dev acc=0.4196
Shuffling training data
Iter 1850: loss=57.2138, time=157.80s
iter 1850: dev acc=0.4405
Shuffling training data
Iter 1900: loss=56.3652, time=161.71s
iter 1900: dev acc=0.4296
Shuffling training data
Iter 1950: loss=56.2823, time=165.64s
iter 1950: dev acc=0.4160
Iter 2000: loss=56.2890, time=169.59s
iter 2000: dev acc=0.4242
Shuffling training data
Iter 2050: loss=55.4579, time=173.54s
iter 2050: dev acc=0.4360
Shuffling training data
Iter 2100: loss=56.0431, time=177.54s
iter 2100: dev acc=0.4314
Shuffling training data
Iter 2150: loss=55.3785, time=181.46s
iter 2150: dev acc=0.4269
Iter 2200: loss=55.4231, time=185.96s
iter 2200: dev acc=0.4160
Shuffling training data
Iter 2250: loss=55.2482, time=190.46s
iter 2250: dev acc=0.4305
Shuffling training data
Iter 2300: loss=55.1322, time=194.49s
iter 2300: dev acc=0.4133
Shuffling training data
Iter 2350: loss=54.2459, time=198.98s
iter 2350: dev acc=0.4269
Iter 2400: loss=53.8157, time=203.16s
iter 2400: dev acc=0.3987
Stopping early because there was no improvement for 1000 steps
Done training
Loading best model
best model iter 1400: train acc=0.4939, dev acc=0.4369, test acc=0.4525
Training new model with seed 2
==================================================
Shuffling training data
Iter 50: loss=79.5742, time=3.74s
iter 50: dev acc=0.2543
new highscore
Shuffling training data
Iter 100: loss=78.0789, time=7.85s
iter 100: dev acc=0.3215
new highscore
Shuffling training data
Iter 150: loss=76.0003, time=12.77s
iter 150: dev acc=0.3533
new highscore
Iter 200: loss=71.6293, time=17.62s
iter 200: dev acc=0.3769
new highscore
Shuffling training data
Iter 250: loss=68.8147, time=22.48s
iter 250: dev acc=0.3878
new highscore
Shuffling training data
Iter 300: loss=67.3741, time=27.41s
iter 300: dev acc=0.3987
new highscore
Shuffling training data
Iter 350: loss=66.8441, time=32.31s
iter 350: dev acc=0.3842
Iter 400: loss=65.4724, time=37.04s
iter 400: dev acc=0.4142
new highscore
Shuffling training data
Iter 450: loss=65.3482, time=41.79s
iter 450: dev acc=0.4169
new highscore
Shuffling training data
Iter 500: loss=64.0183, time=46.09s
iter 500: dev acc=0.4060
Shuffling training data
Iter 550: loss=64.2270, time=50.15s
iter 550: dev acc=0.4160
Iter 600: loss=63.8925, time=54.73s
iter 600: dev acc=0.4069
Shuffling training data
Iter 650: loss=63.1634, time=59.34s
iter 650: dev acc=0.4160
Shuffling training data
Iter 700: loss=63.5108, time=63.86s
iter 700: dev acc=0.4187
new highscore
Shuffling training data
Iter 750: loss=62.2440, time=68.24s
iter 750: dev acc=0.4233
new highscore
Iter 800: loss=62.3044, time=72.85s
iter 800: dev acc=0.4196
Shuffling training data
Iter 850: loss=61.6835, time=77.48s
iter 850: dev acc=0.4296
new highscore
Shuffling training data
Iter 900: loss=61.6219, time=82.24s
iter 900: dev acc=0.4387
new highscore
Shuffling training data
Iter 950: loss=61.6929, time=86.90s
iter 950: dev acc=0.4351
Iter 1000: loss=61.1248, time=91.51s
iter 1000: dev acc=0.4087
Shuffling training data
Iter 1050: loss=60.7503, time=96.05s
iter 1050: dev acc=0.4196
Shuffling training data
Iter 1100: loss=60.7576, time=100.59s
iter 1100: dev acc=0.4178
Shuffling training data
Iter 1150: loss=60.1236, time=105.22s
iter 1150: dev acc=0.4242
Iter 1200: loss=60.3655, time=109.76s
iter 1200: dev acc=0.4223
Shuffling training data
Iter 1250: loss=59.4146, time=114.26s
iter 1250: dev acc=0.4450
new highscore
Shuffling training data
Iter 1300: loss=59.2640, time=118.27s
iter 1300: dev acc=0.4269
Shuffling training data
Iter 1350: loss=59.5809, time=122.19s
iter 1350: dev acc=0.4251
Iter 1400: loss=59.1958, time=126.12s
iter 1400: dev acc=0.4223
Shuffling training data
Iter 1450: loss=58.8319, time=129.99s
iter 1450: dev acc=0.4414
Shuffling training data
Iter 1500: loss=58.3268, time=133.88s
iter 1500: dev acc=0.4151
Shuffling training data
Iter 1550: loss=58.6943, time=137.86s
iter 1550: dev acc=0.4305
Iter 1600: loss=58.6986, time=141.74s
iter 1600: dev acc=0.4342
Shuffling training data
Iter 1650: loss=58.3257, time=145.63s
iter 1650: dev acc=0.4342
Shuffling training data
Iter 1700: loss=57.2304, time=149.65s
iter 1700: dev acc=0.4351
Shuffling training data
Iter 1750: loss=56.9601, time=153.55s
iter 1750: dev acc=0.4287
Iter 1800: loss=57.5493, time=157.63s
iter 1800: dev acc=0.4105
Shuffling training data
Iter 1850: loss=57.0152, time=162.20s
iter 1850: dev acc=0.4369
Shuffling training data
Iter 1900: loss=55.9297, time=166.72s
iter 1900: dev acc=0.4305
Shuffling training data
Iter 1950: loss=56.3127, time=171.15s
iter 1950: dev acc=0.4187
Iter 2000: loss=56.1357, time=175.74s
iter 2000: dev acc=0.4269
Shuffling training data
Iter 2050: loss=55.3940, time=180.41s
iter 2050: dev acc=0.4233
Shuffling training data
Iter 2100: loss=55.0271, time=185.04s
iter 2100: dev acc=0.4242
Shuffling training data
Iter 2150: loss=55.4256, time=189.65s
iter 2150: dev acc=0.4060
Iter 2200: loss=54.7168, time=194.25s
iter 2200: dev acc=0.4351
Shuffling training data
Iter 2250: loss=53.9802, time=198.89s
iter 2250: dev acc=0.4087
Stopping early because there was no improvement for 1000 steps
Done training
Loading best model
best model iter 1250: train acc=0.4841, dev acc=0.4360, test acc=0.4507
Test accuracy: 0.44962292609351434 +- 0.0028697281433545064
/home/lgpu0388/.conda/envs/dl2020/lib/python3.7/site-packages/numpy/core/_asarray.py:136: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  return array(a, dtype, copy=False, order=order, subok=True)
