Training a LSTM model.
Warning: Using pretrained embedding, will override given embedding dimension.
Device: cuda
Loading data...

Loading pretrained embedding...
Permute is turned on!
Training new model with seed 0
==================================================
Shuffling training data
Iter 50: loss=79.2253, time=4.15s
iter 50: dev acc=0.2743
new highscore
Shuffling training data
Iter 100: loss=77.6110, time=8.28s
iter 100: dev acc=0.3370
new highscore
Shuffling training data
Iter 150: loss=74.7602, time=12.36s
iter 150: dev acc=0.3697
new highscore
Iter 200: loss=70.6331, time=16.56s
iter 200: dev acc=0.4069
new highscore
Shuffling training data
Iter 250: loss=68.4331, time=20.73s
iter 250: dev acc=0.3987
Shuffling training data
Iter 300: loss=66.9059, time=24.72s
iter 300: dev acc=0.4114
new highscore
Shuffling training data
Iter 350: loss=66.3361, time=28.90s
iter 350: dev acc=0.4114
Iter 400: loss=65.2680, time=32.97s
iter 400: dev acc=0.4251
new highscore
Shuffling training data
Iter 450: loss=64.6078, time=37.15s
iter 450: dev acc=0.4287
new highscore
Shuffling training data
Iter 500: loss=64.0624, time=41.32s
iter 500: dev acc=0.4178
Shuffling training data
Iter 550: loss=63.5939, time=45.44s
iter 550: dev acc=0.4260
Iter 600: loss=63.2538, time=49.50s
iter 600: dev acc=0.4332
new highscore
Shuffling training data
Iter 650: loss=62.9137, time=53.72s
iter 650: dev acc=0.4278
Shuffling training data
Iter 700: loss=62.3990, time=57.71s
iter 700: dev acc=0.4305
Shuffling training data
Iter 750: loss=62.4550, time=61.75s
iter 750: dev acc=0.4269
Iter 800: loss=62.3441, time=65.79s
iter 800: dev acc=0.4396
new highscore
Shuffling training data
Iter 850: loss=62.1874, time=69.98s
iter 850: dev acc=0.4351
Shuffling training data
Iter 900: loss=61.7986, time=73.92s
iter 900: dev acc=0.4441
new highscore
Shuffling training data
Iter 950: loss=62.4836, time=78.14s
iter 950: dev acc=0.4233
Iter 1000: loss=61.8947, time=82.06s
iter 1000: dev acc=0.4342
Shuffling training data
Iter 1050: loss=61.3816, time=86.11s
iter 1050: dev acc=0.4342
Shuffling training data
Iter 1100: loss=61.0877, time=90.06s
iter 1100: dev acc=0.4269
Shuffling training data
Iter 1150: loss=62.2963, time=94.04s
iter 1150: dev acc=0.4378
Iter 1200: loss=61.4494, time=98.11s
iter 1200: dev acc=0.4414
Shuffling training data
Iter 1250: loss=60.7505, time=102.16s
iter 1250: dev acc=0.4432
Shuffling training data
Iter 1300: loss=61.4686, time=106.22s
iter 1300: dev acc=0.4287
Shuffling training data
Iter 1350: loss=60.9562, time=110.26s
iter 1350: dev acc=0.4387
Iter 1400: loss=60.5696, time=114.31s
iter 1400: dev acc=0.4396
Shuffling training data
Iter 1450: loss=60.1125, time=118.31s
iter 1450: dev acc=0.4360
Shuffling training data
Iter 1500: loss=60.5814, time=122.25s
iter 1500: dev acc=0.4378
Shuffling training data
Iter 1550: loss=60.5518, time=126.25s
iter 1550: dev acc=0.4478
new highscore
Iter 1600: loss=60.4443, time=130.39s
iter 1600: dev acc=0.4369
Shuffling training data
Iter 1650: loss=60.3065, time=134.42s
iter 1650: dev acc=0.4396
Shuffling training data
Iter 1700: loss=59.8256, time=138.43s
iter 1700: dev acc=0.4387
Shuffling training data
Iter 1750: loss=60.2185, time=142.42s
iter 1750: dev acc=0.4587
new highscore
Iter 1800: loss=59.5671, time=146.49s
iter 1800: dev acc=0.4423
Shuffling training data
Iter 1850: loss=59.1888, time=150.49s
iter 1850: dev acc=0.4414
Shuffling training data
Iter 1900: loss=59.9353, time=154.57s
iter 1900: dev acc=0.4369
Shuffling training data
Iter 1950: loss=59.0490, time=158.63s
iter 1950: dev acc=0.4450
Iter 2000: loss=59.5815, time=162.72s
iter 2000: dev acc=0.4496
Shuffling training data
Iter 2050: loss=58.8695, time=166.78s
iter 2050: dev acc=0.4405
Shuffling training data
Iter 2100: loss=58.7628, time=170.76s
iter 2100: dev acc=0.4369
Shuffling training data
Iter 2150: loss=58.8439, time=174.83s
iter 2150: dev acc=0.4423
Iter 2200: loss=58.7895, time=178.82s
iter 2200: dev acc=0.4314
Shuffling training data
Iter 2250: loss=58.6053, time=182.91s
iter 2250: dev acc=0.4387
Shuffling training data
Iter 2300: loss=58.9708, time=186.94s
iter 2300: dev acc=0.4441
Shuffling training data
Iter 2350: loss=57.7688, time=191.02s
iter 2350: dev acc=0.4396
Iter 2400: loss=57.8937, time=195.09s
iter 2400: dev acc=0.4414
Shuffling training data
Iter 2450: loss=58.2703, time=199.10s
iter 2450: dev acc=0.4269
Shuffling training data
Iter 2500: loss=57.4847, time=203.18s
iter 2500: dev acc=0.4305
Shuffling training data
Iter 2550: loss=58.3903, time=207.20s
iter 2550: dev acc=0.4532
Iter 2600: loss=57.8159, time=211.25s
iter 2600: dev acc=0.4450
Shuffling training data
Iter 2650: loss=57.6361, time=215.32s
iter 2650: dev acc=0.4496
Shuffling training data
Iter 2700: loss=57.3937, time=219.36s
iter 2700: dev acc=0.4405
Shuffling training data
Iter 2750: loss=57.4596, time=223.43s
iter 2750: dev acc=0.4432
Stopping early because there was no improvement for 1000 steps
Done training
Loading best model
best model iter 1750: train acc=0.4890, dev acc=0.4478, test acc=0.4615
Training new model with seed 1
==================================================
Shuffling training data
Iter 50: loss=79.2067, time=3.80s
iter 50: dev acc=0.3034
new highscore
Shuffling training data
Iter 100: loss=78.0034, time=7.99s
iter 100: dev acc=0.3243
new highscore
Shuffling training data
Iter 150: loss=74.2889, time=12.09s
iter 150: dev acc=0.3715
new highscore
Iter 200: loss=70.4103, time=16.27s
iter 200: dev acc=0.3815
new highscore
Shuffling training data
Iter 250: loss=68.5490, time=20.43s
iter 250: dev acc=0.3896
new highscore
Shuffling training data
Iter 300: loss=66.6253, time=24.64s
iter 300: dev acc=0.4214
new highscore
Shuffling training data
Iter 350: loss=66.1381, time=28.79s
iter 350: dev acc=0.4124
Iter 400: loss=64.9585, time=32.79s
iter 400: dev acc=0.4296
new highscore
Shuffling training data
Iter 450: loss=64.6953, time=36.95s
iter 450: dev acc=0.4332
new highscore
Shuffling training data
Iter 500: loss=64.0050, time=41.16s
iter 500: dev acc=0.4342
new highscore
Shuffling training data
Iter 550: loss=63.4253, time=45.36s
iter 550: dev acc=0.4405
new highscore
Iter 600: loss=63.3980, time=49.53s
iter 600: dev acc=0.4269
Shuffling training data
Iter 650: loss=63.7488, time=53.53s
iter 650: dev acc=0.4342
Shuffling training data
Iter 700: loss=62.4381, time=57.50s
iter 700: dev acc=0.4387
Shuffling training data
Iter 750: loss=62.5625, time=61.56s
iter 750: dev acc=0.4314
Iter 800: loss=62.5831, time=65.58s
iter 800: dev acc=0.4332
Shuffling training data
Iter 850: loss=61.9011, time=69.58s
iter 850: dev acc=0.4351
Shuffling training data
Iter 900: loss=62.4416, time=73.66s
iter 900: dev acc=0.4287
Shuffling training data
Iter 950: loss=61.5137, time=77.74s
iter 950: dev acc=0.4378
Iter 1000: loss=61.5820, time=81.80s
iter 1000: dev acc=0.4260
Shuffling training data
Iter 1050: loss=61.7127, time=85.85s
iter 1050: dev acc=0.4396
Shuffling training data
Iter 1100: loss=61.8033, time=89.92s
iter 1100: dev acc=0.4450
new highscore
Shuffling training data
Iter 1150: loss=61.0036, time=94.16s
iter 1150: dev acc=0.4460
new highscore
Iter 1200: loss=61.1431, time=98.22s
iter 1200: dev acc=0.4460
Shuffling training data
Iter 1250: loss=61.0436, time=102.26s
iter 1250: dev acc=0.4242
Shuffling training data
Iter 1300: loss=60.8095, time=106.26s
iter 1300: dev acc=0.4432
Shuffling training data
Iter 1350: loss=61.0138, time=110.34s
iter 1350: dev acc=0.4196
Iter 1400: loss=61.1935, time=114.34s
iter 1400: dev acc=0.4351
Shuffling training data
Iter 1450: loss=60.8417, time=118.39s
iter 1450: dev acc=0.4423
Shuffling training data
Iter 1500: loss=59.5424, time=122.38s
iter 1500: dev acc=0.4450
Shuffling training data
Iter 1550: loss=60.3976, time=126.32s
iter 1550: dev acc=0.4441
Iter 1600: loss=60.0832, time=130.31s
iter 1600: dev acc=0.4360
Shuffling training data
Iter 1650: loss=59.8651, time=134.29s
iter 1650: dev acc=0.4396
Shuffling training data
Iter 1700: loss=59.7301, time=138.28s
iter 1700: dev acc=0.4441
Shuffling training data
Iter 1750: loss=59.7777, time=142.29s
iter 1750: dev acc=0.4296
Iter 1800: loss=59.3230, time=146.41s
iter 1800: dev acc=0.4432
Shuffling training data
Iter 1850: loss=59.0871, time=150.48s
iter 1850: dev acc=0.4505
new highscore
Shuffling training data
Iter 1900: loss=60.1266, time=154.68s
iter 1900: dev acc=0.4323
Shuffling training data
Iter 1950: loss=58.8912, time=158.70s
iter 1950: dev acc=0.4342
Iter 2000: loss=59.1768, time=162.69s
iter 2000: dev acc=0.4441
Shuffling training data
Iter 2050: loss=58.9492, time=166.79s
iter 2050: dev acc=0.4441
Shuffling training data
Iter 2100: loss=58.8880, time=170.85s
iter 2100: dev acc=0.4196
Shuffling training data
Iter 2150: loss=59.2785, time=174.91s
iter 2150: dev acc=0.4332
Iter 2200: loss=58.3461, time=178.91s
iter 2200: dev acc=0.4360
Shuffling training data
Iter 2250: loss=58.7439, time=182.95s
iter 2250: dev acc=0.4550
new highscore
Shuffling training data
Iter 2300: loss=57.9426, time=187.01s
iter 2300: dev acc=0.4269
Shuffling training data
Iter 2350: loss=58.7414, time=191.01s
iter 2350: dev acc=0.4378
Iter 2400: loss=57.8632, time=194.97s
iter 2400: dev acc=0.4342
Shuffling training data
Iter 2450: loss=58.5832, time=198.96s
iter 2450: dev acc=0.4369
Shuffling training data
Iter 2500: loss=58.3424, time=203.07s
iter 2500: dev acc=0.4369
Shuffling training data
Iter 2550: loss=57.6823, time=207.11s
iter 2550: dev acc=0.4369
Iter 2600: loss=57.5248, time=211.19s
iter 2600: dev acc=0.4296
Shuffling training data
Iter 2650: loss=56.9632, time=215.16s
iter 2650: dev acc=0.4441
Shuffling training data
Iter 2700: loss=58.0560, time=219.17s
iter 2700: dev acc=0.4423
Shuffling training data
Iter 2750: loss=56.9424, time=223.15s
iter 2750: dev acc=0.4223
Iter 2800: loss=56.7189, time=227.08s
iter 2800: dev acc=0.4142
Shuffling training data
Iter 2850: loss=57.3004, time=231.08s
iter 2850: dev acc=0.4351
Shuffling training data
Iter 2900: loss=56.5796, time=235.06s
iter 2900: dev acc=0.4296
Shuffling training data
Iter 2950: loss=57.2657, time=239.02s
iter 2950: dev acc=0.4378
Iter 3000: loss=56.4007, time=243.02s
iter 3000: dev acc=0.4151
Shuffling training data
Iter 3050: loss=56.2148, time=246.95s
iter 3050: dev acc=0.4342
Shuffling training data
Iter 3100: loss=56.1179, time=250.88s
iter 3100: dev acc=0.4369
Shuffling training data
Iter 3150: loss=56.1726, time=254.88s
iter 3150: dev acc=0.4332
Iter 3200: loss=56.2268, time=258.89s
iter 3200: dev acc=0.4160
Shuffling training data
Iter 3250: loss=55.7629, time=262.95s
iter 3250: dev acc=0.4205
Stopping early because there was no improvement for 1000 steps
Done training
Loading best model
best model iter 2250: train acc=0.5049, dev acc=0.4378, test acc=0.4552
Training new model with seed 2
==================================================
Shuffling training data
Iter 50: loss=79.1435, time=3.72s
iter 50: dev acc=0.2661
new highscore
Shuffling training data
Iter 100: loss=77.4798, time=7.80s
iter 100: dev acc=0.3306
new highscore
Shuffling training data
Iter 150: loss=72.4154, time=11.94s
iter 150: dev acc=0.3742
new highscore
Iter 200: loss=69.7008, time=16.16s
iter 200: dev acc=0.3878
new highscore
Shuffling training data
Iter 250: loss=67.4355, time=20.30s
iter 250: dev acc=0.4142
new highscore
Shuffling training data
Iter 300: loss=66.0038, time=24.46s
iter 300: dev acc=0.4205
new highscore
Shuffling training data
Iter 350: loss=65.9980, time=28.64s
iter 350: dev acc=0.4178
Iter 400: loss=64.7266, time=32.65s
iter 400: dev acc=0.4278
new highscore
Shuffling training data
Iter 450: loss=64.5671, time=36.76s
iter 450: dev acc=0.4223
Shuffling training data
Iter 500: loss=64.1521, time=40.77s
iter 500: dev acc=0.4260
Shuffling training data
Iter 550: loss=63.7211, time=44.69s
iter 550: dev acc=0.4223
Iter 600: loss=63.6014, time=48.63s
iter 600: dev acc=0.4260
Shuffling training data
Iter 650: loss=63.0293, time=52.57s
iter 650: dev acc=0.4360
new highscore
Shuffling training data
Iter 700: loss=63.1407, time=56.62s
iter 700: dev acc=0.4233
Shuffling training data
Iter 750: loss=62.8169, time=60.61s
iter 750: dev acc=0.4323
Iter 800: loss=62.6088, time=64.59s
iter 800: dev acc=0.4314
Shuffling training data
Iter 850: loss=62.3426, time=68.62s
iter 850: dev acc=0.4332
Shuffling training data
Iter 900: loss=62.5731, time=72.55s
iter 900: dev acc=0.4323
Shuffling training data
Iter 950: loss=62.6107, time=76.51s
iter 950: dev acc=0.4323
Iter 1000: loss=61.4677, time=80.55s
iter 1000: dev acc=0.4405
new highscore
Shuffling training data
Iter 1050: loss=61.5975, time=84.68s
iter 1050: dev acc=0.4351
Shuffling training data
Iter 1100: loss=62.1580, time=88.68s
iter 1100: dev acc=0.4469
new highscore
Shuffling training data
Iter 1150: loss=61.4841, time=92.90s
iter 1150: dev acc=0.4487
new highscore
Iter 1200: loss=61.3948, time=97.05s
iter 1200: dev acc=0.4296
Shuffling training data
Iter 1250: loss=61.2163, time=101.16s
iter 1250: dev acc=0.4505
new highscore
Shuffling training data
Iter 1300: loss=60.6761, time=105.33s
iter 1300: dev acc=0.4487
Shuffling training data
Iter 1350: loss=61.3301, time=109.34s
iter 1350: dev acc=0.4351
Iter 1400: loss=61.0688, time=113.41s
iter 1400: dev acc=0.4460
Shuffling training data
Iter 1450: loss=60.4664, time=117.41s
iter 1450: dev acc=0.4514
new highscore
Shuffling training data
Iter 1500: loss=60.8370, time=121.49s
iter 1500: dev acc=0.4441
Shuffling training data
Iter 1550: loss=60.4830, time=125.40s
iter 1550: dev acc=0.4469
Iter 1600: loss=60.2645, time=129.37s
iter 1600: dev acc=0.4496
Shuffling training data
Iter 1650: loss=59.8559, time=133.34s
iter 1650: dev acc=0.4578
new highscore
Shuffling training data
Iter 1700: loss=60.2279, time=137.48s
iter 1700: dev acc=0.4423
Shuffling training data
Iter 1750: loss=60.6430, time=141.46s
iter 1750: dev acc=0.4305
Iter 1800: loss=59.9795, time=145.42s
iter 1800: dev acc=0.4387
Shuffling training data
Iter 1850: loss=59.8742, time=149.39s
iter 1850: dev acc=0.4496
Shuffling training data
Iter 1900: loss=59.3145, time=153.34s
iter 1900: dev acc=0.4469
Shuffling training data
Iter 1950: loss=59.5976, time=157.33s
iter 1950: dev acc=0.4450
Iter 2000: loss=59.1883, time=161.32s
iter 2000: dev acc=0.4369
Shuffling training data
Iter 2050: loss=59.2419, time=165.34s
iter 2050: dev acc=0.4487
Shuffling training data
Iter 2100: loss=59.1671, time=169.33s
iter 2100: dev acc=0.4514
Shuffling training data
Iter 2150: loss=58.7992, time=173.30s
iter 2150: dev acc=0.4496
Iter 2200: loss=59.1877, time=177.29s
iter 2200: dev acc=0.4523
Shuffling training data
Iter 2250: loss=59.5035, time=181.23s
iter 2250: dev acc=0.4332
Shuffling training data
Iter 2300: loss=58.6417, time=185.24s
iter 2300: dev acc=0.4450
Shuffling training data
Iter 2350: loss=58.5264, time=189.17s
iter 2350: dev acc=0.4396
Iter 2400: loss=58.2320, time=193.16s
iter 2400: dev acc=0.4387
Shuffling training data
Iter 2450: loss=58.3530, time=197.10s
iter 2450: dev acc=0.4314
Shuffling training data
Iter 2500: loss=58.4435, time=201.11s
iter 2500: dev acc=0.4396
Shuffling training data
Iter 2550: loss=58.3469, time=205.06s
iter 2550: dev acc=0.4287
Iter 2600: loss=58.1221, time=209.01s
iter 2600: dev acc=0.4287
Shuffling training data
Iter 2650: loss=57.1686, time=212.99s
iter 2650: dev acc=0.4196
Stopping early because there was no improvement for 1000 steps
Done training
Loading best model
best model iter 1650: train acc=0.4810, dev acc=0.4523, test acc=0.4421
Test accuracy: 0.45294117647058824 +- 0.008102790961425833
/home/lgpu0383/.conda/envs/dl2020/lib/python3.7/site-packages/numpy/core/_asarray.py:136: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray
  return array(a, dtype, copy=False, order=order, subok=True)
